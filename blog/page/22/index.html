
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>RockPaperScissors</title>
  <meta name="author" content="Morgan Prior">

  
  <meta name="description" content="I have been trying to use the GeoIP Rack App, by copying this gist in my Rack stack with a Sinatra Application. Heroku has a lot of redirection in &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://morganp.github.io/blog/page/22">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="RockPaperScissors" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Audiowide' rel='stylesheet' type='text/css'>
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-47010631-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">RockPaperScissors</a></h1>
  
    <h2>LizardSpock</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:morganp.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/">Latest</a></li>
  <li><a href="/blog/archives">All</a></li>
  <li><a href="/tag">Tags</a></li>
  <li><a href="/license">License</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/get-client-ip-on-heroku/">Get Client IP on Heroku</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-12T07:41:32+01:00" pubdate data-updated="true">Jul 12<span>th</span>, 2010</time>
        
           | <a href="/blog/tech/get-client-ip-on-heroku/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/get-client-ip-on-heroku/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have been trying to use the <a href="http://coderack.org/users/hosiawak/middlewares/36-geoip-country">GeoIP Rack App</a>, by copying this <a href="http://gist.github.com/208774">gist</a> in my Rack stack with a Sinatra Application. Heroku has a lot of redirection in there Server farm so I have added the following lines to my instance of GeoIP:Rack to make it Heroku safe.</p>

<pre><code>env['HTTP_X_REAL_IP'] ||= env['REMOTE_ADDR']
res = @db.country(env['HTTP_X_REAL_IP'])
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/sinatra-running-on-heroku/">Sinatra Running on Heroku</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-09T08:37:13+01:00" pubdate data-updated="true">Jul 9<span>th</span>, 2010</time>
        
           | <a href="/blog/tech/sinatra-running-on-heroku/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/sinatra-running-on-heroku/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For running small webapps <a href="http://heroku.com/">heroku</a> is free. The real attraction is the simplicity of deployment, if you are use to git you just push to heroku.</p>

<p><a href="http://blog.heroku.com/archives/2009/3/5/32_deploy_merb_sinatra_or_any_rack_app_to_heroku/">Current instructions</a> are missing the step of creating the .gems file. So here is my quick walk through. Register on <a href="http://heroku.com/">heroku</a> first.</p>

<pre><code>mkdir new_web_app
cd new_web_app
gem install heroku
touch config.ru
touch app.rb
touch .gems
</code></pre>

<p>config.ru</p>

<pre><code>require 'app'
run Sinatra::Application
</code></pre>

<p>app.rb</p>

<pre><code>require 'rubygems'
require 'sinatra'

get '/' do
   "Hello from Sinatra on Heroku!"
end
</code></pre>

<p>.gems</p>

<pre><code>sinatra --version '&gt;=1.0'
</code></pre>

<p>Now run these commands to finish off and deploy</p>

<pre><code>git init
git add config.ru app.rb .gems 
git commit -a -m 'Initial commit'
heroku create
git push heroku master
heroku open
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/vim-indenting-with-vim-/">[Vim] Indenting With Vim</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-07T07:50:53+01:00" pubdate data-updated="true">Jul 7<span>th</span>, 2010</time>
        
           | <a href="/blog/tech/vim-indenting-with-vim-/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/vim-indenting-with-vim-/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Vim is a great text editor but has quite a steep learning curve. <a href="http://vimcasts.org">VimCasts</a> is a great podcast for learning about vim.</p>

<p>Indenting is a common programming activity so doing this effectively can greatly speed editing up.</p>

<p>Pressing i to enter INSERT mode then pressing tab will insert a tab or white space as expected. There is a quicker method especially for multiline.</p>

<p><strong>Vim Multi-Line Indent</strong>
Press ESC to enter normal mode. &lsquo;v&rsquo; to enter Visual mode. use the cursors or your normal navigation keys to highlight multiple lines then press &lsquo;&lt;&lt;&rsquo; or &lsquo;>>&rsquo;. This indents in or out but notice that you have gone back to normal mode and your higlighted region has been lost. this is quite frustrating until you realise that you can redo the same command by pressing &lsquo;.&rsquo; and undo with &lsquo;u&rsquo; if you indented to far.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/os-x-itunes-play-ogg-videos/">OS X iTunes Play .ogg Videos</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-06T09:18:22+01:00" pubdate data-updated="true">Jul 6<span>th</span>, 2010</time>
        
           | <a href="/blog/tech/os-x-itunes-play-ogg-videos/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/os-x-itunes-play-ogg-videos/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://pragmatic.tv">Pragmatic TV</a> release there screen casts in iPod, Quicktime and Theora Ogg formats. Since Theora Ogg seems to be the best quality and I want to be able to read the text from the video clearly I would like to integrate playback better into the mac ecosystem.</p>

<p>This is actually fairly trivial with <a href="http://xiph.org/quicktime/download.html">Xiph</a>. Just download, open the .dmg and place the .component in the /Library/Components folder. .ogg videos can now be dragged into and played with iTunes.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/jquery-clear-form-on-focus-and-restore-on-exit/">jQuery Clear Form on Focus and Restore on Exit</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-27T10:57:35+01:00" pubdate data-updated="true">Jun 27<span>th</span>, 2010</time>
        
           | <a href="/blog/tech/jquery-clear-form-on-focus-and-restore-on-exit/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/jquery-clear-form-on-focus-and-restore-on-exit/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I used <a href="http://www.eggchops.com/web-stuff/jquery/jquery-clear-focus-function/">this as a jQuery reference</a> to hide and show default text in forms.</p>

<pre><code>&lt;head&gt;
   &lt;script type=”text/javascript” src=”js/jquery.js”&gt;&lt;/script&gt;
   &lt;script type=”text/javascript”&gt;

   $(document).ready(function(){

      var clearMePrevious = ”;

      // clear input on focus
      $(’.clearMeFocus’).focus(function()
      {
         if($(this).val()==$(this).attr(’title’))
         {
            clearMePrevious = $(this).val();
            $(this).val(”);
         }
       });

       // if field is empty afterward, add text again
       $(’.clearMeFocus’).blur(function()
       {
        if($(this).val()==”)
        {
          $(this).val(clearMePrevious);
        }
    });
});

&lt;/script&gt;
&lt;/head&gt;
</code></pre>

<p>and the for the form</p>

<pre><code>&lt;input type=”text” name=”email” title=”Enter your email” value=”Enter your email” class=”clearMeFocus” /&gt;
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/webfaction-problems-restarting-nginx/">WebFaction Problems Restarting Nginx</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-27T09:39:48+01:00" pubdate data-updated="true">Jun 27<span>th</span>, 2010</time>
        
           | <a href="/blog/tech/webfaction-problems-restarting-nginx/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/webfaction-problems-restarting-nginx/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After updating my website on <a href="http://www.webfaction.com/?affiliate=morgy">webfaction</a> nginx kept saying permission denied and when I tried to view my site I got a 502 Bad Gateway error page.</p>

<p>To restart nginx I use to call:</p>

<pre><code>  ~/webapps/passenger/bin/restart
</code></pre>

<p>I had to change this to:</p>

<pre><code>~/webapps/passenger/nginx/sbin/nginx -p ~/webapps/passenger/nginx/ -s stop  
~/webapps/passenger/nginx/sbin/nginx -p ~/webapps/passenger/nginx/ 
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/vim-show-lines-over-80-charaters-long/">Vim Show Lines Over 80 Charaters Long.</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-26T07:13:52+01:00" pubdate data-updated="true">Jun 26<span>th</span>, 2010</time>
        
           | <a href="/blog/tech/vim-show-lines-over-80-charaters-long/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/vim-show-lines-over-80-charaters-long/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This snippet can be added to you ~/.vimrc to highlight long lines.</p>

<pre><code>" Highlight lines over 80 characters long with red background
highlight OverLength ctermbg=red ctermfg=white guibg=#592929
match OverLength /\%81v.\+/
</code></pre>

<p>When programming it is recommended to keep lines at 80 characters or under. This makes it easier to find the start of the next line, possible to compare two files side by side on modern monitors and source code should print out nicely if required for code reviews.</p>

<p><a href="http://stackoverflow.com/questions/235439/vim-80-column-layout-concerns">source</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/vim-search-and-replace/">Vim Search and Replace</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-24T09:37:37+01:00" pubdate data-updated="true">Jun 24<span>th</span>, 2010</time>
        
           | <a href="/blog/tech/vim-search-and-replace/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/vim-search-and-replace/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>To search in Vim just press (apple-f for macvim) / then search string.</p>

<pre><code>/search
</code></pre>

<p>This will highlight all occurrences of &lsquo;search&rsquo;, to clear the highlighting enter:</p>

<pre><code>:let @/ = ""
</code></pre>

<p>To search and replace the first occurrence on this line only:</p>

<pre><code>:s/search/replace/
</code></pre>

<p>Lines 1 to 10 all instance per line (thats the /g global):</p>

<pre><code>:1,10 s/search/replace/g 
</code></pre>

<p>All Lines All instances</p>

<pre><code>:%s/search/replace/g 
</code></pre>

<p><a href="http://www.linux.com/learn/tutorials/8255-vim-tips-the-basics-of-search-and-replace">Originals source</a><br  />
<a href="http://stackoverflow.com/questions/657447/vim-clear-last-search-highlighting">Stack overflow vim clear question</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/homebrew-package-management-for-mac-os-x/">Homebrew Package Management for Mac OS X</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-22T07:45:14+01:00" pubdate data-updated="true">Jun 22<span>nd</span>, 2010</time>
        
           | <a href="/blog/tech/homebrew-package-management-for-mac-os-x/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/homebrew-package-management-for-mac-os-x/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Homebrew is a new package management system for Mac OS X. <a href="http://www.engineyard.com/blog/2010/homebrew-os-xs-missing-package-manager/">A good review/tutorial on EngineYard</a>.</p>

<p>Update 20-August-2010<br/>
Then method of installation below adds lots (4) extra folders to your home area making it look clutered so I now preffer this method of installation.</p>

<pre><code>ruby -e "$(curl -fsS http://gist.github.com/raw/323731/install_homebrew.rb)";
</code></pre>

<p>Then just make sure &lsquo;/usr/local/bin/&rsquo; and &lsquo;/usr/local/sbin/&rsquo; are on your path.<br/>
Update End</p>

<p>Although I do not like the idea of changing permissions on /usr/local/, so I did:</p>

<pre><code>mkdir -p ~/bin/homebrew
curl -L http://github.com/mxcl/homebrew/tarball/master | tar xz --strip 1 -C ~/bin/homebrew
ln -s ~/bin/homebrew/bin/brew ~/bin/brew

#and make sure ~/bin is on your path with soem thing like this in your ~/.bashrc
# export PATH=$PATH:~/bin
</code></pre>

<p>Now try it out:</p>

<pre><code>$ brew --version
&gt; 0.6
$ brew install wget
Warning: It appears you have Macports or Fink installed
Although, unlikely, this can break builds or cause obscure runtime issues.
If you experience problems try uninstalling these tools.
==&gt; Downloading http://ftp.gnu.org/gnu/wget/wget-1.12.tar.bz2
######################################################################## 100.0%
==&gt; ./configure --disable-debug --prefix=/Users/morgy/bin/homebrew/Cellar/wget/1.12 --disable-iri
==&gt; make install
/Users/morgy/bin/homebrew/Cellar/wget/1.12: 7 files, 576K, built in 44 seconds
</code></pre>

<p>Done</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/creating-executable-gems/">Creating Executable Gems</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-21T08:43:48+01:00" pubdate data-updated="true">Jun 21<span>st</span>, 2010</time>
        
           | <a href="/blog/tech/creating-executable-gems/#disqus_thread"
             data-disqus-identifier="http://morganp.github.io/blog/tech/creating-executable-gems/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is not necessarily the correct way of creating executable gems but a method which worked for me.</p>

<p>Assuming we are working in folder just for this gem we need a structure like this:</p>

<pre><code>my_gem/
   my_gem.gemspec
   bin/
      my_gem #&lt;-script with no file extension
   lib/
      my_gem.rb #&lt;- Actual class file
</code></pre>

<p>my_gem.gemspec</p>

<pre><code>require 'rake/gempackagetask'
spec = Gem::Specification.new do |s|
   s.name         = 'my_gem'
   s.version      = '0.0.1'
   s.platform     = Gem::Platform::RUBY
   s.summary      = 'Report memory usage on Mac OS X, Linux and Unix.'
   s.homepage     = 'http://amaras-tech.co.uk/software/memory_usage'
   s.authors      = "Morgan Prior"
   s.email        = "memory_usage_gem@amaras-tech.co.uk"
   s.description  = "Reports memory used by all current user processes"
   s.files        = ['bin/my_gem', 'lib/my_gem.rb']
   s.bindir       = 'bin'   
   s.executables  = ['my_gem']
   s.has_rdoc     = false

   s.post_install_message = "To use 'my_gem' as a standalone application your gems folder must be on your path"   
end
Rake::GemPackageTask.new(spec).define
</code></pre>

<p>bin/my_gem</p>

<pre><code>#!/usr/bin/env ruby

require 'rubygems'
require 'my_gem'

a = MyGem.new(ARGV)
a.report
</code></pre>

<p>lib/my_gem.rb</p>

<pre><code>class MyGem
    #Any command Line options set are passed in as array argv
    # You cannot have arguments as CONSTANTS plus if it was 
    # ARGV it would clash with the built in ARGV.
    def initialize(argv=[""])
      @msg = "HelloWorld!"
    end

    def report
       puts @msg.to_s
    end
 end
</code></pre>

<p>Then :</p>

<pre><code>$ gem build my_gem.gemspec
</code></pre>

<p>and you can test the install via:</p>

<pre><code>$ gem install my_gem-0.0.1.gem
</code></pre>

<p>Test then uninstall:</p>

<pre><code>$ gem uninstall my_gem
</code></pre>

<p>Push to RubyGems:</p>

<pre><code>$ gem push my_gem-0.0.1.gem
</code></pre>

<p>Then install from ruby Gem:</p>

<pre><code>$ gem install my_gem
</code></pre>

<p>Done, Remember to replace &lsquo;my_gem&rsquo; with a unique but relevant name.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/23/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/21/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/cooking'>Cooking (8)</a></li><li><a href='/blog/engineering'>Engineering (6)</a></li><li><a href='/blog/garden'>Garden (3)</a></li><li><a href='/blog/home'>Home (3)</a></li><li><a href='/blog/photography'>Photography (31)</a></li><li><a href='/blog/tech'>Tech (210)</a></li></ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/home/coffee-table/">Coffee Table</a>
      </li>
    
      <li class="post">
        <a href="/blog/home/chandelier/">Chandelier</a>
      </li>
    
      <li class="post">
        <a href="/blog/photography/f-stop-icus/">F-stop ICUs</a>
      </li>
    
      <li class="post">
        <a href="/blog/home/exact-fit-blinds/">Exact Fit Blinds</a>
      </li>
    
      <li class="post">
        <a href="/blog/engineering/flip-flop/">Flip-flop</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/morganp">@morganp</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'morganp',
            count: 1,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Morgan Prior -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'morganpgithubio';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
