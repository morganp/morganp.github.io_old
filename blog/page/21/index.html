
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>RockPaperScissors</title>
  <meta name="author" content="Morgan Prior">

  
  <meta name="description" content="Working on my site design I thought it would be nice to have user selectable stylesheets, say a black text on white background or white text on black &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lizard-spock.co.uk/blog/page/21">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="RockPaperScissors" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Audiowide' rel='stylesheet' type='text/css'>
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-47010631-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">RockPaperScissors</a></h1>
  
    <h2>LizardSpock</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:lizard-spock.co.uk" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/">Latest</a></li>
  <li><a href="/blog/archives">All</a></li>
  <li><a href="/tag">Tags</a></li>
  <li><a href="/license">License</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/user-selectable-stylesheets-using-sinatra/">User Selectable Stylesheets (Using Sinatra)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-29T21:49:23+01:00" pubdate data-updated="true">Mar 29<span>th</span>, 2012</time>
        
           | <a href="/blog/tech/user-selectable-stylesheets-using-sinatra/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/user-selectable-stylesheets-using-sinatra/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Working on my site design I thought it would be nice to have user selectable stylesheets, say a black text on white background or white text on black background. Once I had this working in development mode I ran into the problem with the stylesheet being cached.</p>

<p>In my implementation the user sets a cookie by visiting a url and being redirected back to the original page. The routing then returned different content for the /stylesheet/screen.css based on the cookie.</p>

<p>From my <a href="http://www.sinatrarb.com/">Sinatra</a> routes:</p>

<pre><code>get '/set_css/:style' do
   ## Set style with /set_css/light?ref=/article
  response.set_cookie("style", { :value =&gt; params[:style], :path =&gt; '/'} ) 

  if params[:ref].nil? or params[:ref] == '' 
    redirect '/'
  else
    redirect params[:ref]
  end
end
</code></pre>

<p>The CSS routes, using sass for rendering</p>

<pre><code>get '/stylesheets/screen.css' do
  content_type 'text/css', :charset =&gt; 'utf-8'
  response['Expires'] = (Time.now + 60*60*24*356).httpdate
  if request.cookies['style'] == 'light'
    sass(:"stylesheets/light_screen" ) 
  else
    sass(:"stylesheets/dark_screen" ) 
  end
end
</code></pre>

<p>The problem mentioned earlier is that the header is set to cache the page for a year. This means that the user would need to force a full webpage refresh. This does not happen automatically using the route which sets the cookie and redirect.</p>

<p>An easy solution to for this is using the cookie to directly load a different named stylesheet. Each stylesheet will get cached but they are different assets to the browser. For my web app I move the if statment into layouts.erb.</p>

<p>Stylesheet routes back to:</p>

<pre><code>get '/stylesheets/:name.css' do
  content_type 'text/css', :charset =&gt; 'utf-8'
  response['Expires'] = (Time.now + 60*60*24*356).httpdate
  sass(:"stylesheets/#{params[:name]}" ) 
end
</code></pre>

<p>Inside my layout.erb</p>

<pre><code>&lt;head&gt;
  &lt;% if request.cookies['style'] == 'light' -%&gt;
  &lt;link href="/stylesheets/light_screen.css" rel="stylesheet" type="text/css" media="screen, projection"/&gt;
  &lt;% else -%&gt;
  &lt;link href="/stylesheets/dark_screen.css" rel="stylesheet" type="text/css" media="screen, projection"/&gt;
  &lt;% end -%&gt;
 &lt;/head&gt;
</code></pre>

<p>The style selection menu:</p>

<pre><code>&lt;ul&gt;
  &lt;li&gt;&lt;a href="/set_css/light?ref=&lt;%=request.fullpath%&gt;"&gt;Light&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href="/set_css/dark?ref=&lt;%=request.fullpath%&gt;"&gt;Dark&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/what-shell-am-i-using/">What Shell Am I Using?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-28T20:43:20+01:00" pubdate data-updated="true">Mar 28<span>th</span>, 2012</time>
        
           | <a href="/blog/tech/what-shell-am-i-using/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/what-shell-am-i-using/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you are working on a new system or with multiple environments it is good to know what type of shell you are using. the answer is in the $0 variable.</p>

<pre><code>echo $0
&gt; bash
</code></pre>

<p>The default shell is $SHELL</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/svn-multi-line-comments-on-the-command-line-/">SVN Multi-line Comments on the Command Line</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-28T13:32:53+01:00" pubdate data-updated="true">Mar 28<span>th</span>, 2012</time>
        
           | <a href="/blog/tech/svn-multi-line-comments-on-the-command-line-/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/svn-multi-line-comments-on-the-command-line-/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Answer:</p>

<pre><code>svn commit -m $'Line 1 \nLine 2'
</code></pre>

<h2>The Problem</h2>

<p>Committing to subversion on the command line and using escaped line returns for multi line comments:</p>

<pre><code>svn commit -m $'Line 1 \nLine 2'
</code></pre>

<p>svn log will show some thing like</p>

<pre><code>------------------------------------------------------------------------
r1 | user | 2012-03-28 13:37:48 +0100 (Wed, 28 Mar 2012) | 1 lines

Line 1 \nLine 2
</code></pre>

<p>Answer originally posted on <a href="http://serverfault.com/questions/148917/use-linefeed-or-carriage-return-in-subversion-commit-message-from-the-command-li">ServerFault</a>. Strings contained in \&lsquo;\&rsquo; should not be interpreted by the command line but:</p>

<pre><code>svn commit -m "Line 1 \nLine 2"
</code></pre>

<p>Shows the same errors. Starting the comment with a $ does seem to fix it.</p>

<pre><code>svn commit -m $'Line 1 \nLine 2'
</code></pre>

<p>Will give:</p>

<pre><code>------------------------------------------------------------------------
r1 | user | 2012-03-28 13:37:48 +0100 (Wed, 28 Mar 2012) | 1 lines

Line 1 
Line 2
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/unix-mail-command-delete-all-messages/">Unix Mail Command, Delete All Messages</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-01T20:44:36+00:00" pubdate data-updated="true">Mar 1<span>st</span>, 2012</time>
        
           | <a href="/blog/tech/unix-mail-command-delete-all-messages/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/unix-mail-command-delete-all-messages/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Cron jobs can have there results returned as mail via the unix mail system. If left unchecked for a while the number of mails can mount up and you probably do not care about the old results. the command <code>d *</code> will delete all mails</p>

<pre><code>$ mail
Mail version 8.1 6/6/93.  Type ? for help.
"/var/mail/lounge": 2726 messages 25 new 2726 unread
? d *
? quit

$ mail
No mail for user
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/list_temp_files-script/">List_temp_files Script</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-20T12:18:21+00:00" pubdate data-updated="true">Feb 20<span>th</span>, 2012</time>
        
           | <a href="/blog/tech/list_temp_files-script/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/list_temp_files-script/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A simple script for finding temp files from the current directory and below. I often run this before adding a new project to a revision control system to ensure temp files do not get added into the repo.</p>

<pre><code>#!/bin/sh

echo "Searching for temp local files/directories"
#vim accidental saves
find . -name "1" -type f 

#Other Temp files
find . -name "*.log" -type f 
find . -name "*.key" -type f
find . -name "*.swp" -type f 
find . -name "results" -type d 
find . -name "waveforms" -type d  

echo "Searching for temp links"
find . -name "results" -type l 
find . -name "waveforms" -type l 

#Accidental checkins
find . -name "*.log" -type l
find . -name "*.key" -type l
find . -name "*.swp" -type l
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/photography/irb-as-a-megapixels-calculator/">Irb as a Megapixels Calculator</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-12T18:56:40+00:00" pubdate data-updated="true">Feb 12<span>th</span>, 2012</time>
        
           | <a href="/blog/photography/irb-as-a-megapixels-calculator/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/photography/irb-as-a-megapixels-calculator/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have just added the method below to my ruby .irbrc file for quickly calculating image megapixels. from OS X the info panel gives the form of &lsquo;23309 × 4412&rsquo; this becomes &lsquo;23309???4412&rsquo; when pasted into iTerm.</p>

<pre><code>def megapixels( dimensions )
  if dimensions.match(/\d*x\d*/)
    x,y = dimensions.split('x')
  end
  if dimensions.match(/\d*\?\?\?\d*/)
    x,y = dimensions.split('???')
  end    

  if x.nil? or y.nil? 
    $stderr.puts "The input #{dimensions} could not be parsed in to megapixels"
    exit -1
  end
  x = x.to_i
  y = y.to_i

  megapixels = (x*y)/10.0**6
end
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/vim-paste-from-insert-mode/">Vim, Paste from Insert Mode</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-27T15:00:55+00:00" pubdate data-updated="true">Jan 27<span>th</span>, 2012</time>
        
           | <a href="/blog/tech/vim-paste-from-insert-mode/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/vim-paste-from-insert-mode/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><pre><code>ctrl-r "
</code></pre>

<p>Actually <code>ctrl-r reg</code>, where &ldquo; is the unnamed register from the last yank or delete.</p>

<h2>Why</h2>

<p>If you have done a block selection and you want to paste, normally you would have to leave selection mode to this and there fore not be able to edit multiple lines at once.</p>

<p>say you have (below) and what to prepend &lsquo;number&rsquo;.</p>

<pre><code>number 
one
two
three
</code></pre>

<p>Place cursor on &lsquo;number&rsquo;, <code>yiw</code> to yank inner word. Move to &lsquo;o&rsquo; of one. <code>ctrl-v</code> to enter block selection, <code>jj</code> to select ott vertically. Then I to enter insert mode. <code>ctrl-r " . ESC</code>.</p>

<pre><code>number 
number.one
number.two
number.three
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/matrix-a-ruby-standard-library/">Matrix: A Ruby Standard Library</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-20T12:09:05+00:00" pubdate data-updated="true">Jan 20<span>th</span>, 2012</time>
        
           | <a href="/blog/tech/matrix-a-ruby-standard-library/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/matrix-a-ruby-standard-library/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://github.com/sandal/guides/wiki/STDLIB:-Matrix">Originally written</a> as an assignment for <a href="http://mendicantuniversity.org/">Ruby Mendicant University</a>.</p>

<p>matrix is part of the <a href="http://ruby-doc.org/stdlib/libdoc/matrix/rdoc/classes/Matrix.html">Ruby Standard Library</a></p>

<h1>Usage</h1>

<p>A note before we start, if using Ruby 1.8 require &lsquo;mathn&rsquo; will make matrix division return more accurate results. With it Rational numbers can be returned with out it Rounded numbers are returned. Ruby 1.9 Rational numbers are used by default.</p>

<pre><code>require 'matrix'
a = Matrix[[1,2], [3,4]] 
=&gt; Matrix[[1, 2], [3, 4]] 
This would look like:  
   1,2
   3,4

a = Matrix.columns([ [1,3],[2,4] ]) #Note Rows and columns swapped
=&gt; Matrix[[1, 2], [3, 4]] 

This would still look like
   1,2
   3,4
</code></pre>

<p>If you already have the row defined as a Arrays then using rows they can be combined into a matrix</p>

<pre><code>row1 = [1,2]
row2 = [3,4]
a = Matrix[ row1,row2 ]
#This is also the same as:
b = Matrix.rows([ row1, row2 ])
</code></pre>

<p>This by defaults to copying the arrays, i.e. any change to Matrix a will not effect row1 or row2. If you would like the row1 and row2 to be pointers to the respective rows then a boolean switch can be used to control this behaviour</p>

<pre><code>row1 = [1,2]
row2 = [3,4]
a = Matrix.rows([ row1, row2 ], false)
=&gt; Matrix[[1, 2], [3, 4]]
row1[0] = 9
puts a
=&gt; Matrix[[9, 2], [3, 4]]
</code></pre>

<p>Note that you can not replace entire rows with:</p>

<pre><code>row1 = [5,6]
puts a 
=&gt; Matrix[[9, 2], [3, 4]]
</code></pre>

<p>This is because row1 has become a new Array and does not modify the existing array, Matrix a now contains the old Array row1.</p>

<h2>Identity &amp; Operators</h2>

<p>For matrix mathematics the identity matrix is very useful, more can be read <a href="http://en.wikipedia.org/wiki/Identity_matrix">here</a>. The identity matrix is often represented by I, its definition, given a matrix M:</p>

<pre><code>M*I = I*M = M
</code></pre>

<p>As it is a core part of matrices mathematics they are very simple to create in ruby.</p>

<pre><code>i = Matrix.identity(2)
=&gt; Matrix[[1,0],[0,1]]

i = Matrix.identity(3)
=&gt; Matrix[[1, 0, 0], [0, 1, 0], [0, 0, 1]]
</code></pre>

<p>Addition and subtraction (and multiplication by scalars) work as expected</p>

<pre><code>a =  Matrix[ [1,1], [2,2] ] + Matrix.identity(2)
=&gt; Matrix[[2, 1], [2, 3]]

s = Matrix[ [1,1], [2,2] ] - Matrix.identity(2)
=&gt; Matrix[[0, 1], [2, 1]]

m =  Matrix.identity(2) * 3
=&gt; Matrix[[3, 0], [0, 3]] 
NB: this is the same as Matrix.scalar(2, 3)
</code></pre>

<p>Matrix by Matrix Multiplication is only possible with m by p multiplied by p by n, i.e. the inner dimension must match. This will result in an m x n matrix. In the next example a 1,4 * 4,1 results in 1,1 a single element matrix.</p>

<pre><code>[ [1 2 3 4] ]*[ [1]    =&gt; 1*1 + 2*2 + 3*3 + 4*4 = Matrix[ [30] ]
                [2]
                [3]
                [4] ]
</code></pre>

<p>For a 2,2 * 2,2 results in a 2,2</p>

<pre><code>[[a,b],  * [[w,x]   =&gt; [[a*w + b*y], [a*x + b*x]
 [c,d]]     [y,z]]      [c*w + d*y], [c*x + d*z]]
</code></pre>

<p>At first glance this might not seem any thing special but there are a few mathematical properties that make this incredibly useful, rotation and solving linear equations for example.</p>

<h1>Rotation</h1>

<p><a href="http://xkcd.com/184/"><img src="http://imgs.xkcd.com/comics/matrix_transform.png"></a>
<em>Comic from <a href="http://xkcd.com/184/">kxcd</a></em></p>

<p>Rotating a 2,1 matrix is relatively trivial. This can be used to rotate a set of x,y coordinates and makes rotating vector images trivial.</p>

<pre><code>[ [cos(x), -sin(x)]   * [[x] 
  [sin(x),  cos(x)] ]    [y]]
</code></pre>

<h1>Solving Linear Equations (Linear Algebra)</h1>

<p>Here I would like to introduce the inverse function. Which is as simple as calling inverse, be careful though as not all matrices have an inverse and then it will throw &lsquo;ExceptionForMatrix::ErrNotRegular: Not Regular Matrix&rsquo;. Any matrix multiplied by its inverse will lead to the identity matrix.</p>

<pre><code>a = Matrix.scalar(4,3) * Matrix.scalar(4,3).inverse
=&gt; Matrix[[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]]
</code></pre>

<p>Two dimensional matrices are often used to help solve linear equations. Whereby we have x unknowns we can calculate the single solution if it exists with x equations.</p>

<p>For example:</p>

<pre><code>1a + 2b + 3c = 38
4a + 5b + 6c = 92
7a + 8b + 0c = 83
</code></pre>

<p>Can be rewritten as:</p>

<pre><code>[[1, 2, 3], * [[ a ],  = [[ 38 ],
 [4, 5, 6],    [ b ],     [ 92 ],
 [7, 8, 0]]    [ c ]]     [ 83 ]]

This can be generalised to A.x = y
</code></pre>

<p>When the inverse of A exists it can be solved for x, by multiplying both sides by A^-1</p>

<pre><code>A.x = y
x   = A^-1.y

A = Matrix[ [1, 2, 3], [4,5,6], [7,8,0] ]
y = Matrix[ [38], [92], [83] ]

x = A.inverse * y
=&gt; Matrix[[5], [6], [7]]
</code></pre>

<p>For sanity lets just check that.</p>

<pre><code>a = x[0,0]
b = x[1,0]
c = x[2,0]

1*a + 2*b + 3*c 
=&gt; 38
4*a + 5*b + 6*c 
=&gt; 92
7*a + 8*b + 0*c 
=&gt; 83
</code></pre>

<p>All Equations return expected results.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/recursive-grep-with-filtering/">Recursive Grep, with Filtering</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-19T15:56:31+00:00" pubdate data-updated="true">Jan 19<span>th</span>, 2012</time>
        
           | <a href="/blog/tech/recursive-grep-with-filtering/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/recursive-grep-with-filtering/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I noticed today that greps recursive function is different to finds recursion.</p>

<pre><code>find ./ -name *.txt
grep -R 'text' *.text
</code></pre>

<p>The above find command will search from the sub-directory down while grep will only search the current folder. The FILE_PATTERN must also match the hierarchy in grep.</p>

<p>To apply a file type filter in grep you can do:</p>

<pre><code>grep -R --include=*.txt 'text' ./
</code></pre>

<p>This looks at all file from the current directory (./) but will only grep files which match the include.</p>

<p>An older article on <a href="http://amaras-tech.co.uk/article/63">Basic grep usage</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/tech/finding-tracks-not-in-itunes/">Finding Tracks Not in iTunes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-14T18:19:45+00:00" pubdate data-updated="true">Jan 14<span>th</span>, 2012</time>
        
           | <a href="/blog/tech/finding-tracks-not-in-itunes/#disqus_thread"
             data-disqus-identifier="http://lizard-spock.co.uk/blog/tech/finding-tracks-not-in-itunes/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After switching my Audio ripper (<a href="http://sbooth.org/Max">Max</a>) accidentally to &lsquo;AAC Low Delay&rsquo; rather than plain &lsquo;AAC&rsquo; I realised too late after about 20-30cd rips that they were not appearing in iTunes.</p>

<p>I also convert to flac to converting to the correct format from source is still relatively easy. Finding which track are in my iTunes folder but not in the iTunes library is a little bit more tricky. Well it was going to be until I found <a href="http://dougscripts.com/itunes/scripts/ss.php?sp=musicfolderfilesnotadded2">this Dougs Script</a>.</p>

<p>I did not have to instal any script for this just ran the app insdie the download for &lsquo;Music Folder Files Not Added v3.0&rsquo;. My iTune folder is in the default location so I just had to press &lsquo;find&rsquo; and it took around a minute to list all the music tracks I had but iTunes had not added to its library.</p>

<p>Working my way through the list recreating the tracks in the correct AAC format, just adding the &lsquo;iTunes Music&rsquo; folder to iTunes after every ablum fix and hitting &lsquo;find&rsquo; in Dougs app to refresh the list.</p>

<p>Easy, almsot got a ruby version of it working but only got so far:</p>

<pre><code>gem install 'itunes-library'
</code></pre>

<p>The Script:</p>

<pre><code>require 'itunes/library'

path       = File.expand_path( "~/Music/iTunes/iTunes Music" )
itunes_lib = File.expand_path( "~/Music/iTunes/iTunes Library.xml" )
library    = ITunes::Library.load( itunes_lib )

puts  "#{library.music.tracks.size} Tracks have been loaded"

files = Dir.glob( File.join(path, '**', '*.m4a'  ) )

files.each do |music_file|
  music_file_nice = music_file.dup
  music_file.gsub!(' ', '%20')
  music_file.gsub!('#', '%231')
  #music_file.gsub!('´', '%C2%B4')

  #This comes last so it the # does not get replace
  music_file.gsub!('&amp;', '&amp;') 

  #Correcting filename prefix / location
  music_file.gsub!('/Users/morgy/Music', 'file://localhost/Volumes/Queeg500TimeM')

  found = []
  #found = library.music.tracks.keep_if { |t| t.to_hash['Location'] == music_file }
  library.music.tracks.each { |t| 
    if t.to_hash['Location'] == music_file
      found &lt;&lt; t
    end
  }

  if found.empty? 
    puts
    puts "MISSING #{music_file_nice}"
  end

end
</code></pre>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/22/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/20/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/cooking'>Cooking (11)</a></li><li><a href='/blog/engineering'>Engineering (36)</a></li><li><a href='/blog/garden'>Garden (14)</a></li><li><a href='/blog/home'>Home (5)</a></li><li><a href='/blog/outdoor'>Outdoor (1)</a></li><li><a href='/blog/photography'>Photography (37)</a></li><li><a href='/blog/tech'>Tech (240)</a></li></ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/photography/f-stop-loka-and-tripod/">F-Stop Loka &amp; Tripod</a>
      </li>
    
      <li class="post">
        <a href="/blog/tech/word-word-the-difference/">Word WORD the Difference</a>
      </li>
    
      <li class="post">
        <a href="/blog/tech/list-files-ignored-by-git/">List Files Ignored by Git</a>
      </li>
    
      <li class="post">
        <a href="/blog/tech/xkill/">Xkill</a>
      </li>
    
      <li class="post">
        <a href="/blog/engineering/submit-to-sge-as-if-working-locally/">Submit to SGE as if Working Locally</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/morganp">@morganp</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'morganp',
            count: 1,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Morgan Prior -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'morganpgithubio';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
